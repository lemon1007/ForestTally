import{u as x,I as C,b as S,F as i,a as B,M as F,v as N,c as j,h as m}from"./index.634734d0.js";import{bz as g,bD as k,bw as f,bE as e,bP as c,bU as D}from"./vendor.3d1f4046.js";import"./vant.c7f9a482.js";import"./mock.598c5236.js";const E="_logo_ly99d_1",I="_icon_ly99d_8",M="_appName_ly99d_12",n={logo:E,icon:I,appName:M},O=d=>{const t=g(d);return{ref:t,toggle:()=>t.value=!t.value,on:()=>t.value=!0,off:()=>t.value=!1}},z=k({setup:(d,t)=>{const b=x(),o=f({email:"sariel107@sina.com",code:""}),s=f({email:[],code:[]}),u=g(),{ref:y,toggle:U,on:v,off:h}=O(!1),_=D(),V=async a=>{if(a.preventDefault(),Object.assign(s,{email:[],code:[]}),Object.assign(s,N(o,[{key:"email",type:"required",message:"\u5FC5\u586B"},{key:"email",type:"pattern",regex:/.+@.+/,message:"\u5FC5\u987B\u662F\u90AE\u7BB1\u5730\u5740"},{key:"code",type:"required",message:"\u5FC5\u586B"}])),!j(s)){const l=await m.post("/session",o).catch(p);localStorage.setItem("jwt",l.data.jwt),b.refreshMe(),_.push("/")}},p=a=>{throw a.response&&a.response.status===422&&Object.assign(s,a.response.data.errors),a},w=async()=>{v(),await m.post("/validation_codes",{email:o.email},{_autoLoading:!0}).catch(p).finally(h),u.value.startCount()};return()=>e(F,null,{title:()=>e("div",{style:"margin-left:-35px"},[c("\u767B\u5F55")]),default:()=>e("div",{class:n.wrapper},[e("div",{class:n.logo},[e(C,{class:n.icon,name:"tree"},null),e("h1",{class:n.appName},[c("\u68EE\u6797\u8BB0\u8D26")])]),e(S,{onSubmit:V},{default:()=>{var a,l;return[e(i,{label:"\u90AE\u7BB1\u5730\u5740",type:"text",placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1\uFF0C\u7136\u540E\u70B9\u51FB\u53D1\u9001\u9A8C\u8BC1\u7801",modelValue:o.email,"onUpdate:modelValue":r=>o.email=r,error:(a=s.email)==null?void 0:a[0]},null),e(i,{ref:u,label:"\u9A8C\u8BC1\u7801",type:"validationCode",placeholder:"\u8BF7\u8F93\u5165\u516D\u4F4D\u6570\u5B57",countFrom:5,onClick:w,disabled:y.value,modelValue:o.code,"onUpdate:modelValue":r=>o.code=r,error:(l=s.code)==null?void 0:l[0]},null),e(i,{style:{paddingTop:"96px"}},{default:()=>[e(B,{type:"submit"},{default:()=>[c("\u767B\u5F55")]})]})]}})])})}});export{z as SignInPage,z as default};
